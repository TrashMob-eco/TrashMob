<?xml version="1.0" encoding="utf-8"?>

<createEvent:BaseStepClass xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                           xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                           xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
                           xmlns:viewModels="clr-namespace:TrashMobMobile.ViewModels"
                           xmlns:createEvent="clr-namespace:TrashMobMobile.Pages.CreateEvent"
                           xmlns:createEvent1="clr-namespace:TrashMobMobile.Pages.CreateEvent"
                           xmlns:converters="clr-namespace:TrashMobMobile.Converters"
                           xmlns:controls="clr-namespace:TrashMobMobile.Controls"
                           x:DataType="viewModels:CreateEventViewModel"
                           x:Class="TrashMobMobile.Pages.CreateEvent.Step1">
    <createEvent1:Step1.Resources>
        <ResourceDictionary>
            <converters:StringToBoolConverter x:Key="StringToBoolConverter" />
        </ResourceDictionary>
    </createEvent1:Step1.Resources>
    <ScrollView>
        <VerticalStackLayout Spacing="8" Margin="2">

            <!-- Event Details Card -->
            <Border Style="{StaticResource RoundBorder}" Margin="4,4">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Event Details" Style="{StaticResource SectionHeader}" Margin="0" />
                    <VerticalStackLayout Spacing="4">
                        <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Name" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                        <controls:TMEntry HeightRequest="40"
                            Text="{Binding EventViewModel.Name}" />
                    </VerticalStackLayout>
                    <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Event Type" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                            <controls:TMPicker Title="Event Type"
                                               HeightRequest="40"
                                               ItemsSource="{Binding ETypes}"
                                               SelectedItem="{Binding SelectedEventType, Mode=TwoWay}" />
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Text="Visibility" Style="{StaticResource FieldLabel}" />
                            <controls:TMPicker Title="Visibility"
                                               HeightRequest="40"
                                               ItemsSource="{Binding VisibilityOptions}"
                                               SelectedItem="{Binding SelectedVisibility, Mode=TwoWay}" />
                        </VerticalStackLayout>
                    </Grid>
                    <VerticalStackLayout Spacing="4"
                                         IsVisible="{Binding IsTeamPickerVisible}">
                        <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Team" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                        <controls:TMPicker Title="Select Team"
                                           HeightRequest="40"
                                           ItemsSource="{Binding TeamNames}"
                                           SelectedItem="{Binding SelectedTeam, Mode=TwoWay}" />
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Border>

            <!-- Date & Time Card -->
            <Border Style="{StaticResource RoundBorder}" Margin="4,0">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Date &amp; Time" Style="{StaticResource SectionHeader}" Margin="0" />
                    <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Date" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                            <controls:TMDatePicker HeightRequest="45"
                                       Date="{Binding EventViewModel.EventDateOnly, Mode=TwoWay}" />
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Time" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                            <controls:TMTimePicker Time="{Binding EventViewModel.EventTime, Mode=TwoWay}" />
                        </VerticalStackLayout>
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <!-- Duration Card -->
            <Border Style="{StaticResource RoundBorder}" Margin="4,0">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Duration" Style="{StaticResource SectionHeader}" Margin="0" />
                    <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0" Spacing="4">
                            <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Hours" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                            <controls:TMEntry Keyboard="Numeric" HeightRequest="40"
                                              Text="{Binding EventViewModel.DurationHours}" />
                        </VerticalStackLayout>
                        <VerticalStackLayout Grid.Column="1" Spacing="4">
                            <Label Style="{StaticResource FieldLabel}"><Label.FormattedText><FormattedString><Span Text="Minutes" /><Span Text=" *" TextColor="{StaticResource Destructive}" /></FormattedString></Label.FormattedText></Label>
                            <controls:TMEntry Keyboard="Numeric" HeightRequest="40"
                                              Text="{Binding EventViewModel.DurationMinutes}" />
                        </VerticalStackLayout>
                    </Grid>
                    <Label Style="{StaticResource ErrorLabel}"
                           IsVisible="{Binding EventDurationError, Converter={StaticResource StringToBoolConverter}}"
                           Text="{Binding EventDurationError}" />
                </VerticalStackLayout>
            </Border>

            <!-- Max Attendees Card -->
            <Border Style="{StaticResource RoundBorder}" Margin="4,0">
                <VerticalStackLayout Spacing="4">
                    <Label Text="Max Attendees" Style="{StaticResource FieldLabel}" />
                    <controls:TMEntry Keyboard="Numeric"
                          HeightRequest="40"
                          Text="{Binding EventViewModel.MaxNumberOfParticipants}">
                        <controls:TMEntry.Behaviors>
                            <toolkit:NumericValidationBehavior Flags="ValidateOnValueChanged"
                                                   x:Name="maxNumberOfParticipantsValidator"
                                                   MinimumValue="0"
                                                   MaximumDecimalPlaces="0" />
                        </controls:TMEntry.Behaviors>
                    </controls:TMEntry>
                </VerticalStackLayout>
            </Border>

            <!-- Description Card -->
            <Border Style="{StaticResource RoundBorder}" Margin="4,0,4,4">
                <VerticalStackLayout Spacing="8">
                    <Label Text="Description" Style="{StaticResource SectionHeader}" Margin="0" />
                    <controls:TMEditor
                        Placeholder="Describe your event here"
                        MinimumHeightRequest="100"
                        Text="{Binding EventViewModel.Description}" />
                    <Label Style="{StaticResource ErrorLabel}"
                           IsVisible="{Binding DescriptionRequiredError, Converter={StaticResource StringToBoolConverter}}"
                           Text="{Binding DescriptionRequiredError}" />
                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>
</createEvent:BaseStepClass>
